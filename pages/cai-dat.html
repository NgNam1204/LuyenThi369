<!DOCTYPE html>
<html lang="vi" data-theme="dark">
<head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Ng√¢n h√†ng ƒë·ªÅ ‚Äì LuyenThi369</title>
<link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;500;600;700;800;900&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
<style>

*{margin:0;padding:0;box-sizing:border-box}
:root{
  --bg:#080b10;--bg2:#0d1017;--surface:#161c28;--border:#1e2840;
  --accent:#00e5ff;--accent2:#7c3aed;--accent3:#f59e0b;
  --green:#10b981;--red:#ef4444;
  --text:#e8edf5;--muted:#5a6b88;--card:#111622;
  --shadow:0 4px 24px rgba(0,0,0,.4);
  --radius:14px;
}
[data-theme="light"]{
  --bg:#f5f7ff;--bg2:#ffffff;--surface:#edf0fb;--border:#dce3f5;
  --text:#111827;--muted:#6b7a99;--card:#ffffff;
  --shadow:0 2px 16px rgba(100,120,200,.12);
}
body{background:var(--bg);color:var(--text);font-family:'Be Vietnam Pro',sans-serif;transition:background .3s,color .3s;line-height:1.5}
::-webkit-scrollbar{width:4px}::-webkit-scrollbar-track{background:var(--bg)}::-webkit-scrollbar-thumb{background:var(--border);border-radius:2px}
/* layout */
.app{display:flex;min-height:100vh}
.sidebar{width:260px;background:var(--bg2);border-right:1px solid var(--border);display:flex;flex-direction:column;position:fixed;height:100vh;overflow-y:auto;z-index:100;transition:background .3s,border-color .3s}
.logo{padding:20px;display:flex;align-items:center;gap:11px;border-bottom:1px solid var(--border);text-decoration:none}
.logo-icon{width:36px;height:36px;background:linear-gradient(135deg,var(--accent),var(--accent2));border-radius:10px;display:grid;place-items:center;font-size:18px;flex-shrink:0;box-shadow:0 0 16px rgba(0,229,255,.3)}
.logo-text{font-size:16px;font-weight:800;color:var(--text)}.logo-text em{font-style:normal;color:var(--accent)}
.nav{flex:1;padding:12px 0}
.nav-sec{margin-bottom:4px}
.nav-lbl{font-size:10px;font-weight:700;letter-spacing:2px;color:var(--muted);padding:8px 20px;text-transform:uppercase;opacity:.7}
.nav-a{display:flex;align-items:center;gap:12px;padding:10px 20px;color:var(--muted);font-size:14px;font-weight:500;transition:.2s;border-left:3px solid transparent;text-decoration:none;border-radius:0}
.nav-a:hover{color:var(--text);background:rgba(128,128,200,.06)}
.nav-a.active{color:var(--accent);background:rgba(0,229,255,.07);border-left-color:var(--accent);font-weight:600}
.nav-a .ic{width:18px;text-align:center;flex-shrink:0;font-size:17px}
.badge{margin-left:auto;background:linear-gradient(135deg,var(--accent2),#6d28d9);color:#fff;font-size:10px;font-weight:700;padding:2px 7px;border-radius:999px}
.sb-foot{padding:14px;border-top:1px solid var(--border)}
.user-card{display:flex;align-items:center;gap:10px;background:var(--surface);padding:10px 12px;border-radius:12px;cursor:pointer;text-decoration:none;transition:.2s;border:1px solid transparent}
.user-card:hover{border-color:var(--accent)}
.av{width:34px;height:34px;border-radius:50%;background:linear-gradient(135deg,var(--accent2),var(--accent));display:grid;place-items:center;font-size:18px;font-weight:700;flex-shrink:0;color:#fff}
.uname{font-size:14px;font-weight:600;color:var(--text);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:130px}
.uplan{font-size:12px;color:var(--accent3);font-weight:600}
.logout{margin-top:8px;display:flex;align-items:center;gap:8px;padding:8px 12px;border-radius:10px;cursor:pointer;color:var(--muted);font-size:14px;font-weight:600;transition:.2s;border:none;background:none;font-family:inherit;width:100%}
.logout:hover{color:var(--red);background:rgba(239,68,68,.06)}
/* main */
.main{margin-left:260px;flex:1;display:flex;flex-direction:column;min-height:100vh;min-width:0;overflow-x:hidden}
.topbar{position:fixed;top:0;left:260px;right:0;z-index:50;background:rgba(8,11,16,.9);backdrop-filter:blur(16px);-webkit-backdrop-filter:blur(16px);border-bottom:1px solid var(--border);padding:0 32px;height:60px;display:flex;align-items:center;justify-content:space-between;transition:background .3s,border-color .3s,left .28s}
[data-theme="light"] .topbar{background:rgba(245,247,255,.92)}
.topbar-l .ttl{font-size:22px;font-weight:800;letter-spacing:-.3px;line-height:1.2}
.topbar-l .tsub{font-size:13px;color:var(--muted);margin-top:1px}
.topbar-r{display:flex;align-items:center;gap:8px}
/* buttons */
.btn{display:inline-flex;align-items:center;gap:7px;padding:8px 18px;border-radius:9px;font-size:14px;font-weight:600;cursor:pointer;border:none;transition:.2s;font-family:inherit;white-space:nowrap}
.btn-p{background:var(--accent);color:#000}.btn-p:hover{background:#00cfeb;transform:translateY(-1px)}
.btn-g{background:var(--surface);color:var(--muted);border:1px solid var(--border)}.btn-g:hover{color:var(--text);border-color:var(--muted)}
.btn-v{background:linear-gradient(135deg,var(--accent2),#6d28d9);color:#fff}.btn-v:hover{transform:translateY(-1px);box-shadow:0 4px 16px rgba(124,58,237,.4)}
.icon-btn{width:36px;height:36px;border-radius:9px;background:var(--surface);border:1px solid var(--border);display:grid;place-items:center;cursor:pointer;transition:.2s;font-size:16px}
.icon-btn:hover{border-color:var(--accent)}
/* content */
.content{padding:24px 28px;flex:1;min-width:0;overflow-x:hidden;padding-top:84px}
/* cards */
.card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);padding:24px;transition:background .3s,border-color .3s;min-width:0;overflow:hidden}
[data-theme="light"] .card{box-shadow:var(--shadow)}
.card-title{font-size:14px;font-weight:700;margin-bottom:18px;display:flex;align-items:center;gap:8px}
/* progress bar */
.pbar{height:6px;background:var(--surface);border-radius:999px;overflow:hidden}
.pbar-fill{height:100%;border-radius:999px;transition:width .5s ease}
/* animation */
@keyframes fadeUp{from{opacity:0;transform:translateY(16px)}to{opacity:1;transform:translateY(0)}}
.fadein>*{animation:fadeUp .35s ease both}
.fadein>*:nth-child(2){animation-delay:.05s}
.fadein>*:nth-child(3){animation-delay:.1s}
.fadein>*:nth-child(4){animation-delay:.15s}
/* footer */
.site-footer{background:#06090f;border-top:1px solid #1a2030;padding:36px 40px 24px;margin-top:auto;transition:background .3s,border-color .3s}
[data-theme="light"] .site-footer{background:#eef1fb;border-top-color:#c8d4f0}
/* light mode text */
[data-theme="light"] .sf-addr{color:#3a4a6a}
[data-theme="light"] .sf-addr strong{color:#0f1a35}
[data-theme="light"] .sf-member{color:#3a4a6a}
[data-theme="light"] .sf-label{color:#5a6a8a}
[data-theme="light"] .sf-copy,[data-theme="light"] .sf-brand{color:#5a6a8a}
[data-theme="light"] .sf-bottom{border-top-color:#c8d4f0}
[data-theme="light"] .sf-col:first-child,[data-theme="light"] .sf-col:nth-child(2){border-right-color:#c8d4f0}
[data-theme="light"] .sf-map iframe{border-color:#c8d4f0}
[data-theme="light"] .sf-fb a{background:#dce6ff;color:#0f1a35;border-color:#1877f2}
/* layout */
.sf-inner{display:table;width:100%;table-layout:fixed;border-collapse:collapse}
.sf-col{display:table-cell;width:33.333%;vertical-align:top;padding:0 28px;text-align:center}
.sf-col:first-child{padding-left:0;text-align:left;border-right:1px solid #1e2840}
.sf-col:nth-child(2){border-right:1px solid #1e2840}
.sf-col:last-child{padding-right:0}
.sf-label{font-size:13px;font-weight:700;text-transform:uppercase;letter-spacing:2px;color:#4a5878;margin-bottom:16px;display:block;text-align:center}
.sf-col:first-child .sf-label{text-align:left}
.sf-addr{font-size:14px;color:#8899bb;line-height:1.9}
.sf-addr strong{color:#c8d4f0;font-weight:700}
.sf-map{margin-top:14px}
.sf-map iframe{border-radius:10px;width:100%;height:150px;border:1px solid #1e2840;display:block}
.sf-members{display:inline-flex;flex-direction:column;gap:10px;align-items:flex-start}
.sf-member{display:flex;align-items:center;gap:9px;font-size:14px;color:#8899bb;white-space:nowrap}
[data-theme="light"] .sf-member{color:#3a4a6a}
.sf-member::before{content:'';width:7px;height:7px;border-radius:50%;background:var(--accent);flex-shrink:0}
.sf-fb{display:flex;justify-content:center;width:100%}
.sf-fb a{display:inline-flex;align-items:center;gap:9px;background:#1a2236;color:#e8edf5;font-size:14px;font-weight:600;padding:10px 22px;border-radius:12px;border:1px solid #1877f2;text-decoration:none;transition:.2s}
[data-theme="light"] .sf-fb a{background:#dce6ff;color:#1a2545;border-color:#1877f2}
.sf-fb a:hover{background:#1877f2;color:#fff}
.sf-bottom{margin-top:24px;padding-top:16px;border-top:1px solid #1a2030;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:8px;transition:border-color .3s}
[data-theme="light"] .sf-bottom{border-top-color:#c8d4f0}
.sf-copy,.sf-brand{font-size:13px;color:#3a4868;transition:color .3s}
[data-theme="light"] .sf-copy,[data-theme="light"] .sf-brand{color:#7a8aaa}

.filter-bar{display:flex;gap:10px;margin-bottom:24px;flex-wrap:wrap;align-items:center}
.sw{position:relative;flex:1;min-width:200px}
.sw::before{content:'üîç';position:absolute;left:12px;top:50%;transform:translateY(-50%);font-size:14px;pointer-events:none}
.sw input{width:100%;background:var(--card);border:1px solid var(--border);padding:10px 14px 10px 36px;border-radius:10px;color:var(--text);font-family:inherit;font-size:14px;outline:none;transition:.2s}
[data-theme="light"] .sw input{background:#fff}
.sw input:focus{border-color:var(--accent)}
.sw input::placeholder{color:var(--muted)}
.fsel{background:var(--card);border:1px solid var(--border);color:var(--text);padding:10px 14px;border-radius:10px;font-family:inherit;font-size:14px;cursor:pointer;outline:none;transition:.2s}
[data-theme="light"] .fsel{background:#fff}
.fsel:focus{border-color:var(--accent)}
.tabs-row{display:flex;gap:8px;margin-bottom:20px;flex-wrap:wrap}
.ftab{padding:7px 16px;border-radius:8px;border:1px solid var(--border);background:var(--card);font-size:13px;font-weight:600;cursor:pointer;transition:.2s;color:var(--muted)}
.ftab:hover{border-color:var(--muted);color:var(--text)}
.ftab.active{background:var(--accent);color:#000;border-color:var(--accent)}
.bank-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:14px}
.bi{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:20px;cursor:pointer;transition:.25s}
[data-theme="light"] .bi{box-shadow:var(--shadow)}
.bi:hover{border-color:var(--accent3);transform:translateY(-2px)}
.bi-hdr{display:flex;align-items:center;gap:10px;margin-bottom:10px}
.bib{padding:3px 10px;border-radius:6px;font-size:11px;font-weight:700}
.bb-bo{background:rgba(16,185,129,.12);color:var(--green)}
.bb-truong{background:rgba(0,229,255,.1);color:var(--accent)}
.bb-dd{background:rgba(245,158,11,.12);color:var(--accent3)}
.bb-ai{background:rgba(124,58,237,.12);color:#a78bfa}
.bi-year{font-size:12px;color:var(--muted)}
.bi-title{font-size:15px;font-weight:700;margin-bottom:6px}
.bi-meta{font-size:12px;color:var(--muted);margin-bottom:12px}
.bi-foot{display:flex;align-items:center;justify-content:space-between}
.bi-diff{font-size:12px;font-weight:600}
.diff-e{color:var(--green)}.diff-m{color:var(--accent3)}.diff-h{color:var(--red)}
.start-btn{padding:7px 16px;font-size:13px;font-weight:700;border:none;border-radius:8px;cursor:pointer;font-family:inherit;transition:.2s;background:var(--accent);color:#000}
.start-btn:hover{background:#00cfeb}
.prev-ov{display:none;position:fixed;inset:0;background:rgba(0,0,0,.8);backdrop-filter:blur(10px);z-index:200;align-items:center;justify-content:center}
.prev-ov.show{display:flex}
.prev-box{background:var(--bg2);border:1px solid var(--border);border-radius:20px;width:680px;max-width:95vw;max-height:88vh;overflow:hidden;display:flex;flex-direction:column;box-shadow:0 32px 80px rgba(0,0,0,.5)}
.prev-hdr{padding:18px 24px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between}
.prev-title{font-size:15px;font-weight:800}
.prev-close{width:30px;height:30px;border-radius:8px;border:1px solid var(--border);background:var(--surface);cursor:pointer;display:grid;place-items:center;color:var(--muted);transition:.2s}
.prev-close:hover{color:var(--red);border-color:var(--red)}
.prev-body{padding:24px;overflow-y:auto;flex:1}
.prev-info{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-bottom:20px}
.pi{background:var(--surface);border-radius:10px;padding:12px;text-align:center}
.piv{font-size:18px;font-weight:800;font-family:'Space Mono';color:var(--accent)}
.pil{font-size:17px;color:var(--muted);margin-top:3px}
.prev-foot{padding:14px 24px;border-top:1px solid var(--border);display:flex;gap:10px;justify-content:flex-end}

/* ‚îÄ‚îÄ MOBILE ‚îÄ‚îÄ */
.sidebar-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.55);z-index:98;backdrop-filter:blur(4px);cursor:pointer}
.sidebar-overlay.show{display:block}
.hamburger{width:38px;height:38px;border-radius:9px;background:var(--surface);border:1px solid var(--border);align-items:center;justify-content:center;cursor:pointer;font-size:18px;flex-shrink:0;transition:.2s;margin-right:10px;display:none}
.hamburger:hover{border-color:var(--accent)}
.sidebar-close{display:none;position:absolute;top:16px;right:10px;width:32px;height:32px;border-radius:8px;background:var(--surface);border:1px solid var(--border);align-items:center;justify-content:center;cursor:pointer;font-size:22px;font-weight:700;color:var(--muted);transition:.2s;z-index:10;line-height:1}
.sidebar-close:hover{color:var(--accent);border-color:var(--accent)}
@media(max-width:768px){
  .hamburger{display:flex!important}
  .sidebar-close{display:flex}
  .sidebar{position:fixed;left:0;top:0;height:100vh;transform:translateX(-260px);transition:transform .28s cubic-bezier(.4,0,.2,1);z-index:99;box-shadow:4px 0 24px rgba(0,0,0,.4)}
  .sidebar.open{transform:translateX(0)}
  .main{margin-left:0!important;width:100%}
  .topbar{padding:0 16px;left:0}
  .content{padding:16px}
  .grid-4{grid-template-columns:repeat(2,1fr)!important}
  .grid-2{grid-template-columns:1fr!important}
  .two-col{grid-template-columns:1fr!important}
  .modes{grid-template-columns:repeat(2,1fr)!important}
  .topics{grid-template-columns:repeat(2,1fr)!important}
  .parts-grid{grid-template-columns:1fr!important}
  .stats-row{grid-template-columns:repeat(2,1fr)!important}
  .settings-layout{grid-template-columns:1fr!important}
  .bank-grid{grid-template-columns:1fr!important}
  .qbox{max-height:98vh;border-radius:16px 16px 0 0;position:fixed;bottom:0;left:0;right:0;width:100%!important;max-width:100%!important}
  .qov{align-items:flex-end}
  .exam-box{border-radius:16px 16px 0 0;position:fixed;bottom:0;left:0;right:0;width:100%!important;max-width:100%!important;max-height:95vh}
  .exam-ov{align-items:flex-end}
  .exam-body{flex-direction:column}
  .exam-parts{width:100%!important;height:auto;flex-direction:row;overflow-x:auto;padding:10px;display:flex;gap:8px;border-right:none;border-bottom:1px solid var(--border)}
  .ep-part{flex-shrink:0;padding:8px 12px;margin-bottom:0}
  .prev-box{border-radius:16px 16px 0 0;position:fixed;bottom:0;left:0;right:0;width:100%!important;max-width:100%!important}
  .prev-ov{align-items:flex-end}
  .topbar-l .ttl{font-size:17px}
  .topbar-l .tsub{display:none}
  .welcome-banner{flex-direction:column}
  .cd-band{flex-direction:column;gap:10px}
  .hbtns{flex-direction:column}
  .hsa-hero{padding:24px 16px}
  .sf-inner{display:flex!important;flex-direction:column!important}
  .sf-col{width:100%!important;padding:16px 0!important;border:none!important;display:block!important;text-align:center!important}
  .sf-col:first-child{text-align:center!important}
  .sf-bottom{flex-direction:column;align-items:flex-start;gap:4px}
}

/* ‚ïê‚ïê‚ïê GLOBAL UI ENHANCEMENTS ‚ïê‚ïê‚ïê */

/* Smooth page entry */
body{animation:pageLoad .4s cubic-bezier(.2,.8,.3,1)}
@keyframes pageLoad{from{opacity:0}to{opacity:1}}

/* Card hover lift */
.card{transition:all .25s cubic-bezier(.2,.8,.3,1)!important}
.card:hover{border-color:rgba(0,229,255,.25)!important;transform:translateY(-2px);box-shadow:0 8px 32px rgba(0,0,0,.3)!important}

/* Stat cards glow on hover */
.stat-c:hover{border-color:var(--accent)!important;box-shadow:0 0 20px rgba(0,229,255,.1)!important}

/* Nav items smooth */
.nav-a{transition:all .18s cubic-bezier(.2,.8,.3,1)!important}

/* Logo pulse */
@keyframes logoPulse{0%,100%{box-shadow:0 0 16px rgba(0,229,255,.3)}50%{box-shadow:0 0 28px rgba(0,229,255,.5)}}
.logo-icon{animation:logoPulse 3s ease-in-out infinite}

/* Topbar shadow on scroll */
.topbar{transition:box-shadow .3s,background .3s,border-color .3s,left .28s!important}
.topbar.scrolled{box-shadow:0 4px 32px rgba(0,0,0,.3)!important}

/* Buttons ripple */
.btn{position:relative;overflow:hidden}
.btn::after{content:'';position:absolute;inset:0;background:rgba(255,255,255,.1);opacity:0;border-radius:inherit;transform:scale(0);transition:.3s}
.btn:active::after{transform:scale(1);opacity:1;transition:0s}

/* Progress bars animated on load */
.pbar-fill{animation:growBar .9s cubic-bezier(.2,.8,.3,1) both}
@keyframes growBar{from{width:0!important}to{}}

/* Suggestion items slide */
.sug-item{transition:all .18s cubic-bezier(.2,.8,.3,1)!important}
.sug-item:hover{transform:translateX(5px)!important;background:rgba(0,229,255,.03)!important}

/* Topic cards */
.tc{transition:all .2s cubic-bezier(.2,.8,.3,1)!important}
.tc:hover{transform:translateY(-4px)!important;box-shadow:0 12px 32px rgba(0,0,0,.3)!important}

/* Mode cards */
.mode-c{transition:all .2s cubic-bezier(.2,.8,.3,1)!important}
.mode-c:hover{transform:translateY(-3px)!important;box-shadow:0 8px 24px rgba(0,0,0,.25)!important}

/* Part cards HSA */
.part-c{transition:all .2s cubic-bezier(.2,.8,.3,1)!important}
.part-c:hover{transform:translateY(-4px)!important;box-shadow:0 12px 32px rgba(0,0,0,.3)!important}

/* Scrollbar upgrade */
::-webkit-scrollbar{width:5px;height:5px}
::-webkit-scrollbar-track{background:transparent}
::-webkit-scrollbar-thumb{background:rgba(0,229,255,.2);border-radius:3px}
::-webkit-scrollbar-thumb:hover{background:rgba(0,229,255,.4)}

/* Selection color */
::selection{background:rgba(0,229,255,.25);color:var(--text)}

/* Footer members hover */
.sf-member{transition:.2s}
.sf-member:hover{color:var(--accent)!important;transform:translateX(4px)}

/* Icon buttons */
.icon-btn{transition:all .18s cubic-bezier(.2,.8,.3,1)!important}
.icon-btn:hover{transform:translateY(-1px)!important;background:rgba(0,229,255,.08)!important}

/* Leaderboard items */
.lb-item{transition:.18s}
.lb-item:hover{background:rgba(0,229,255,.04);border-radius:8px;padding-left:8px}

/* Schedule items */
.sched-item{transition:.18s}
.sched-item:hover{background:rgba(0,229,255,.03);border-radius:10px;padding:12px 8px}

/* Badge pop */
.badge{animation:badgePop 2s ease-in-out infinite}
@keyframes badgePop{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}

/* HSA Hero gradient animate */
.hsa-hero{background:linear-gradient(135deg,rgba(124,58,237,.08),rgba(0,229,255,.04),rgba(245,158,11,.04))!important;background-size:200%!important;animation:heroGrad 6s ease-in-out infinite!important}
@keyframes heroGrad{0%,100%{background-position:0% 50%}50%{background-position:100% 50%}}

/* Streak flame */
.streak-flame,.streak-icon{animation:flameDance 2s ease-in-out infinite}
@keyframes flameDance{0%,100%{transform:rotate(-4deg) scale(1)}25%{transform:rotate(4deg) scale(1.07)}50%{transform:rotate(-2deg) scale(1.04)}75%{transform:rotate(3deg) scale(1.06)}}

/* Count-up animation for stats */
.stat-val,.sh-sv,.srv{animation:countUp .6s cubic-bezier(.2,.8,.3,1) both}
@keyframes countUp{from{opacity:0;transform:scale(.7) translateY(10px)}to{opacity:1;transform:none}}
</style>
</head>
<body>
<div class="app">
<div class="sidebar-overlay" id="sb-overlay" onclick="closeSidebar()"></div>

<aside class="sidebar">
  <button class="sidebar-close" onclick="closeSidebar()">‚Äπ</button>
  <a class="logo" href="dashboard.html">
    <div class="logo-icon">üìö</div>
    <div class="logo-text">Luyen<em>Thi</em>369</div>
  </a>
  <nav class="nav">
    <div class="nav-sec">
      <div class="nav-lbl">T·ªïng quan</div>
      <a class="nav-a " href="dashboard.html"><span class="ic">üè†</span>Trang ch·ªß</a>
    </div>
    <div class="nav-sec">
      <div class="nav-lbl">Luy·ªán t·∫≠p</div>
      <a class="nav-a " href="luyen-mon.html"><span class="ic">üìñ</span>Luy·ªán theo m√¥n</a>
      <a class="nav-a " href="hsa.html"><span class="ic">üèõÔ∏è</span>Ph√≤ng luy·ªán HSA<span class="badge">HOT</span></a>
    </div>
    <div class="nav-sec">
      <div class="nav-lbl">Tra c·ª©u</div>
      <a class="nav-a active" href="ngan-hang-de.html"><span class="ic">üóÇÔ∏è</span>Ng√¢n h√†ng ƒë·ªÅ</a>
      <a class="nav-a " href="cai-dat.html"><span class="ic">‚öôÔ∏è</span>C√†i ƒë·∫∑t</a>
    </div>
  </nav>
  <div class="sb-foot">
    <a class="user-card" href="cai-dat.html">
      <div class="av" id="sb-av">?</div>
      <div><div class="uname" id="sb-name">ƒêang t·∫£i...</div><div class="uplan">‚≠ê PRO</div></div>
    </a>
    <button class="logout" onclick="location.href='dang-nhap.html'">üö™ ƒêƒÉng xu·∫•t</button>
  </div>
</aside>

<div class="main">
  <div class="topbar">
    <div class="topbar-l" style="display:flex;align-items:center;gap:10px"><button class="hamburger" onclick="openSidebar()">‚ò∞</button><div style="display:flex;flex-direction:column"><div class="ttl">Ng√¢n h√†ng ƒë·ªÅ</div><div class="tsub">L·ªçc theo m√¥n & nƒÉm</div></div></div>
    <div class="topbar-r"><button class="icon-btn" onclick="Pomodoro.open()" title="Pomodoro">üçÖ</button><button class="btn btn-v" onclick="Battle.open()" style="gap:6px">‚öîÔ∏è Battle</button><button class="icon-btn" id="theme-btn" onclick="toggleTheme()">‚òÄÔ∏è</button></div>
  </div>
  <div class="content fadein">
    <div class="filter-bar">
      <div class="sw"><input type="text" id="search-inp" placeholder="T√¨m ƒë·ªÅ thi..." oninput="filterBank()"></div>
      <select class="fsel" id="sel-mon" onchange="filterBank()">
        <option value="">T·∫•t c·∫£ m√¥n</option>
        <option value="To√°n">To√°n</option>
        <option value="V·∫≠t l√Ω">V·∫≠t l√Ω</option>
        <option value="H√≥a h·ªçc">H√≥a h·ªçc</option>
        <option value="Sinh h·ªçc">Sinh h·ªçc</option>
        <option value="Ti·∫øng Anh">Ti·∫øng Anh</option>
        <option value="HSA">HSA</option>
      </select>
      <select class="fsel" id="sel-year" onchange="filterBank()">
        <option value="">T·∫•t c·∫£ nƒÉm</option>
        <option value="2025">2025</option>
        <option value="2024">2024</option>
        <option value="2023">2023</option>
        <option value="2022">2022</option>
      </select>
    </div>
    <div class="tabs-row">
      <div class="ftab active" onclick="setTab('all',this)">T·∫•t c·∫£ (14)</div>
      <div class="ftab" onclick="setTab('bo',this)">üìö B·ªô GD&ƒêT</div>
      <div class="ftab" onclick="setTab('truong',this)">üè´ Tr∆∞·ªùng THPT</div>
      <div class="ftab" onclick="setTab('dd',this)">üìù ƒê·ªÅ d·ª± ƒëo√°n</div>
      <div class="ftab" onclick="setTab('ai',this)">ü§ñ AI t·∫°o</div>
    </div>
    <div class="bank-grid" id="bank-grid"></div>
  </div>
  
<footer class="site-footer">
  <div class="sf-inner">
    <div class="sf-col">
      <div class="sf-label">ƒê·ªãa ch·ªâ</div>
      <div class="sf-addr">
        <strong>L·ªõp 12A4</strong><br>
        Tr∆∞·ªùng THPT ƒêan Ph∆∞·ª£ng<br>
        Th·ªã tr·∫•n Ph√πng, huy·ªán ƒêan Ph∆∞·ª£ng<br>
        H√† N·ªôi
      </div>
      <div class="sf-map">
        <iframe src="https://maps.google.com/maps?q=Tr%C6%B0%E1%BB%9Dng%20THPT%20%C4%90an%20Ph%C6%B0%E1%BB%A3ng&t=&z=15&ie=UTF8&iwloc=&output=embed" allowfullscreen loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
      </div>
    </div>
    <div class="sf-col">
      <div class="sf-label">Th√†nh vi√™n nh√≥m</div>
      <div class="sf-members">
        <div class="sf-member">Nguy·ªÖn Th·∫ø H·∫£i Nam</div>
        <div class="sf-member">Do√£n H√† Anh</div>
        <div class="sf-member">Nguy·ªÖn Huy·ªÅn Linh</div>
        <div class="sf-member">ƒê·ªó Minh Ph∆∞∆°ng</div>
        <div class="sf-member">Nguy·ªÖn Th·ªã Mai Trang</div>
      </div>
    </div>
    <div class="sf-col">
      <div class="sf-label">M·∫°ng x√£ h·ªôi</div>
      <div class="sf-fb">
        <a href="https://facebook.com" target="_blank">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="#1877f2"><path d="M24 12.073C24 5.405 18.627 0 12 0S0 5.405 0 12.073C0 18.1 4.388 23.094 10.125 24v-8.437H7.078v-3.49h3.047V9.413c0-3.025 1.792-4.697 4.533-4.697 1.312 0 2.686.235 2.686.235v2.953h-1.513c-1.491 0-1.956.93-1.956 1.886v2.284h3.328l-.532 3.49h-2.796V24C19.612 23.094 24 18.1 24 12.073z"/></svg>
          Facebook
        </a>
      </div>
    </div>
  </div>
  <div class="sf-bottom">
    <span class="sf-copy">¬© 2026 LuyenThi369</span>
    <span class="sf-brand">L·ªõp 12A4 ¬∑ Tr∆∞·ªùng THPT ƒêan Ph∆∞·ª£ng</span>
  </div>
</footer>

</div>
</div>
<!-- PREVIEW OVERLAY -->
<div class="prev-ov" id="prev-ov">
  <div class="prev-box">
    <div class="prev-hdr">
      <div class="prev-title" id="prev-title">Xem tr∆∞·ªõc ƒë·ªÅ</div>
      <div class="prev-close" onclick="closePrev()">‚úï</div>
    </div>
    <div class="prev-body" id="prev-body"></div>
    <div class="prev-foot">
      <button class="btn btn-g" onclick="closePrev()">ƒê√≥ng</button>
      <button class="btn btn-p">‚ñ∂ B·∫Øt ƒë·∫ßu l√†m ƒë·ªÅ</button>
    </div>
  </div>
</div>
<script>

function applyTheme(t){
  document.documentElement.setAttribute('data-theme',t);
  localStorage.setItem('lt369_theme',t);
  const b=document.getElementById('theme-btn');
  if(b) b.textContent=t==='dark'?'‚òÄÔ∏è':'üåô';
}
function toggleTheme(){applyTheme(document.documentElement.getAttribute('data-theme')==='dark'?'light':'dark')}


(function(){
  applyTheme(localStorage.getItem('lt369_theme')||'dark');
  const n=localStorage.getItem('lt369_user')||'b·∫°n';
  const av=document.getElementById('sb-av');
  const nm=document.getElementById('sb-name');
  if(av) av.textContent=n.charAt(0).toUpperCase();
  if(nm) nm.textContent=n;
  const el=document.getElementById('na-bank');
  if(el) el.classList.add('active');
})();

const BANK=[
  {id:1,title:'ƒê·ªÅ thi THPT Qu·ªëc gia 2025 ‚Äì M√¥n To√°n',type:'bo',mon:'To√°n',year:'2025',q:50,time:90,diff:'Kh√≥',score:'9.2'},
  {id:2,title:'ƒê·ªÅ thi THPT Qu·ªëc gia 2025 ‚Äì V·∫≠t l√Ω',type:'bo',mon:'V·∫≠t l√Ω',year:'2025',q:40,time:50,diff:'Kh√≥',score:'8.8'},
  {id:3,title:'ƒê·ªÅ thi THPT Qu·ªëc gia 2025 ‚Äì H√≥a h·ªçc',type:'bo',mon:'H√≥a h·ªçc',year:'2025',q:40,time:50,diff:'Trung b√¨nh',score:'8.5'},
  {id:4,title:'ƒê·ªÅ thi THPT Qu·ªëc gia 2024 ‚Äì M√¥n To√°n',type:'bo',mon:'To√°n',year:'2024',q:50,time:90,diff:'Trung b√¨nh',score:'8.0'},
  {id:5,title:'ƒê·ªÅ thi THPT Qu·ªëc gia 2024 ‚Äì Ti·∫øng Anh',type:'bo',mon:'Ti·∫øng Anh',year:'2024',q:50,time:60,diff:'Trung b√¨nh',score:'7.8'},
  {id:6,title:'ƒê·ªÅ th·ª≠ nghi·ªám THPT 2026 ‚Äì THPT ƒêan Ph∆∞·ª£ng',type:'truong',mon:'T·ªïng h·ª£p',year:'2025',q:40,time:60,diff:'D·ªÖ',score:'9.0'},
  {id:7,title:'ƒê·ªÅ ki·ªÉm tra HK1 2025 ‚Äì To√°n',type:'truong',mon:'To√°n',year:'2025',q:30,time:45,diff:'D·ªÖ',score:'9.5'},
  {id:8,title:'ƒê·ªÅ ki·ªÉm tra HK1 2025 ‚Äì H√≥a h·ªçc',type:'truong',mon:'H√≥a h·ªçc',year:'2025',q:30,time:45,diff:'D·ªÖ',score:'8.7'},
  {id:9,title:'ƒê·ªÅ d·ª± ƒëo√°n THPT 2026 ‚Äì To√°n (ƒê·ªÅ 1)',type:'dd',mon:'To√°n',year:'2026',q:50,time:90,diff:'Kh√≥',score:'7.5'},
  {id:10,title:'ƒê·ªÅ d·ª± ƒëo√°n THPT 2026 ‚Äì V·∫≠t l√Ω (ƒê·ªÅ 1)',type:'dd',mon:'V·∫≠t l√Ω',year:'2026',q:40,time:50,diff:'Kh√≥',score:'7.2'},
  {id:11,title:'ƒê·ªÅ d·ª± ƒëo√°n THPT 2026 ‚Äì Ti·∫øng Anh',type:'dd',mon:'Ti·∫øng Anh',year:'2026',q:50,time:60,diff:'Trung b√¨nh',score:'8.1'},
  {id:12,title:'HSA Mock Test #10 ‚Äì Full ƒë·ªÅ 150 c√¢u',type:'ai',mon:'HSA',year:'2025',q:150,time:195,diff:'Kh√≥',score:'112'},
  {id:13,title:'HSA Mock Test #11 ‚Äì T∆∞ duy ƒë·ªãnh l∆∞·ª£ng',type:'ai',mon:'HSA',year:'2025',q:50,time:75,diff:'Kh√≥',score:'45'},
  {id:14,title:'AI Generated ‚Äì ƒê·ªÅ t·ªïng h·ª£p 2026',type:'ai',mon:'T·ªïng h·ª£p',year:'2026',q:40,time:60,diff:'Trung b√¨nh',score:'8.3'},
];
const TYPE_LABELS={bo:'üìö B·ªô GD&ƒêT',truong:'üè´ Tr∆∞·ªùng THPT',dd:'üìù ƒê·ªÅ d·ª± ƒëo√°n',ai:'ü§ñ AI t·∫°o'};
const TYPE_CLASSES={bo:'bb-bo',truong:'bb-truong',dd:'bb-dd',ai:'bb-ai'};
const DIFF_CLASSES={Kh√≥:'diff-h','Trung b√¨nh':'diff-m',D·ªÖ:'diff-e'};
let currentTab='all';
function renderBank(data){
  document.getElementById('bank-grid').innerHTML=data.map(d=>`
    <div class="bi" onclick="openPrev(${d.id})">
      <div class="bi-hdr">
        <span class="bib ${TYPE_CLASSES[d.type]}">${TYPE_LABELS[d.type]}</span>
        <span class="bi-year">${d.year}</span>
      </div>
      <div class="bi-title">${d.title}</div>
      <div class="bi-meta">${d.mon} ¬∑ ${d.q} c√¢u ¬∑ ${d.time} ph√∫t</div>
      <div class="bi-foot">
        <span class="bi-diff ${DIFF_CLASSES[d.diff]}">‚óè ${d.diff}</span>
        <button class="start-btn" onclick="event.stopPropagation()">‚ñ∂ L√†m ƒë·ªÅ</button>
      </div>
    </div>`).join('');
}
function filterBank(){
  const s=document.getElementById('search-inp').value.toLowerCase();
  const m=document.getElementById('sel-mon').value;
  const y=document.getElementById('sel-year').value;
  let data=BANK.filter(d=>
    (currentTab==='all'||d.type===currentTab)&&
    (!s||d.title.toLowerCase().includes(s))&&
    (!m||d.mon===m)&&
    (!y||d.year===y)
  );
  renderBank(data);
}
function setTab(t,el){currentTab=t;document.querySelectorAll('.ftab').forEach(e=>e.classList.remove('active'));el.classList.add('active');filterBank()}
function openPrev(id){
  const d=BANK.find(b=>b.id===id);if(!d)return;
  document.getElementById('prev-title').textContent=d.title;
  document.getElementById('prev-body').innerHTML=`
    <div class="prev-info">
      <div class="pi"><div class="piv">${d.q}</div><div class="pil">C√¢u h·ªèi</div></div>
      <div class="pi"><div class="piv">${d.time}'</div><div class="pil">Th·ªùi gian</div></div>
      <div class="pi"><div class="piv" style="font-size:14px">${d.diff}</div><div class="pil">ƒê·ªô kh√≥</div></div>
    </div>
    <p style="font-size:13px;color:var(--muted);margin-bottom:16px">M√¥n: <strong style="color:var(--text)">${d.mon}</strong> ¬∑ NƒÉm: <strong style="color:var(--text)">${d.year}</strong> ¬∑ Ngu·ªìn: <strong style="color:var(--text)">${TYPE_LABELS[d.type]}</strong></p>
    <p style="font-size:13px;color:var(--muted)">ƒêi·ªÉm trung b√¨nh ng∆∞·ªùi d√πng: <strong style="color:var(--accent);font-family:'Space Mono'">${d.score}</strong></p>`;
  document.getElementById('prev-ov').classList.add('show');
  document.body.style.overflow='hidden';
}
function closePrev(){document.getElementById('prev-ov').classList.remove('show');document.body.style.overflow=''}
renderBank(BANK);


// Topbar scroll shadow
window.addEventListener('scroll',()=>{
  const tb=document.querySelector('.topbar');
  if(tb) tb.classList.toggle('scrolled',window.scrollY>10);
});
function openSidebar(){
  document.querySelector('.sidebar').classList.add('open');
  var ov=document.getElementById('sb-overlay');
  if(ov)ov.classList.add('show');
  document.body.style.overflow='hidden';
}
function closeSidebar(){
  document.querySelector('.sidebar').classList.remove('open');
  var ov=document.getElementById('sb-overlay');
  if(ov)ov.classList.remove('show');
  document.body.style.overflow='';
}
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// SHARED ENHANCEMENTS - LuyenThi369
// Battle Mode + Sound + Confetti + UI upgrades
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

// ‚îÄ‚îÄ WEB AUDIO SOUND ENGINE ‚îÄ‚îÄ
const SFX = (function(){
  let ctx = null;
  function getCtx(){ if(!ctx) ctx = new (window.AudioContext||window.webkitAudioContext)(); return ctx; }
  function play(freq, type, duration, gain=0.3){
    try{
      const c=getCtx(), o=c.createOscillator(), g=c.createGain();
      o.connect(g); g.connect(c.destination);
      o.type=type; o.frequency.setValueAtTime(freq,c.currentTime);
      g.gain.setValueAtTime(gain,c.currentTime);
      g.gain.exponentialRampToValueAtTime(0.001,c.currentTime+duration);
      o.start(c.currentTime); o.stop(c.currentTime+duration);
    } catch(e){}
  }
  return {
    correct(){ play(523,  'sine', 0.12, 0.25); setTimeout(()=>play(659,'sine',0.12,0.2),80); setTimeout(()=>play(784,'sine',0.18,0.18),160); },
    wrong(){   play(200,  'sawtooth', 0.15, 0.18); setTimeout(()=>play(160,'sawtooth',0.1,0.18),100); },
    flip(){    play(880,  'sine', 0.06, 0.08); },
    click(){   play(1200, 'sine', 0.04, 0.05); },
    streak(){  [523,659,784,1047].forEach((f,i)=>setTimeout(()=>play(f,'sine',0.2,0.3),i*80)); },
    countdown(){ play(440,'square',0.1,0.08); },
    finish(){  [784,988,1175,1568].forEach((f,i)=>setTimeout(()=>play(f,'sine',0.25,0.3),i*100)); },
    battle_start(){ [262,330,392,523].forEach((f,i)=>setTimeout(()=>play(f,'triangle',0.2,0.25),i*60)); }
  };
})();

// ‚îÄ‚îÄ CONFETTI ENGINE ‚îÄ‚îÄ
const Confetti = (function(){
  let canvas, ctx2, pieces=[], anim=null;
  const COLORS=['#00e5ff','#7c3aed','#f59e0b','#10b981','#ef4444','#a78bfa','#34d399','#fbbf24'];
  function init(){
    if(canvas) return;
    canvas=document.createElement('canvas');
    canvas.style.cssText='position:fixed;inset:0;pointer-events:none;z-index:99999;';
    document.body.appendChild(canvas);
    ctx2=canvas.getContext('2d');
    resize(); window.addEventListener('resize',resize);
  }
  function resize(){ if(canvas){canvas.width=innerWidth;canvas.height=innerHeight;} }
  function burst(n=120){
    init();
    for(let i=0;i<n;i++){
      pieces.push({
        x:Math.random()*innerWidth, y:-20,
        vx:(Math.random()-0.5)*8, vy:Math.random()*6+3,
        rot:Math.random()*360, rotV:(Math.random()-0.5)*8,
        w:Math.random()*10+5, h:Math.random()*6+3,
        color:COLORS[Math.floor(Math.random()*COLORS.length)],
        alpha:1, gravity:0.15
      });
    }
    if(!anim) loop();
  }
  function loop(){
    ctx2.clearRect(0,0,canvas.width,canvas.height);
    pieces=pieces.filter(p=>{
      p.x+=p.vx; p.y+=p.vy; p.vy+=p.gravity;
      p.rot+=p.rotV; p.alpha-=0.008;
      if(p.alpha<=0||p.y>canvas.height+20) return false;
      ctx2.save(); ctx2.translate(p.x,p.y); ctx2.rotate(p.rot*Math.PI/180);
      ctx2.globalAlpha=p.alpha; ctx2.fillStyle=p.color;
      ctx2.fillRect(-p.w/2,-p.h/2,p.w,p.h);
      ctx2.restore();
      return true;
    });
    if(pieces.length>0){anim=requestAnimationFrame(loop);}
    else{anim=null; ctx2.clearRect(0,0,canvas.width,canvas.height);}
  }
  return { burst };
})();

// ‚îÄ‚îÄ TOAST SYSTEM ‚îÄ‚îÄ
function showToast(ic, title, sub, color=''){
  let t=document.getElementById('global-toast');
  if(!t){
    t=document.createElement('div'); t.id='global-toast';
    t.style.cssText='position:fixed;bottom:24px;right:24px;background:linear-gradient(135deg,#1a2236,#0d1220);border:1px solid #1e2840;border-radius:14px;padding:14px 20px;display:flex;align-items:center;gap:12px;z-index:9998;transform:translateY(80px);opacity:0;transition:.4s cubic-bezier(.2,.8,.3,1);box-shadow:0 8px 32px rgba(0,0,0,.5);max-width:300px;pointer-events:none;';
    document.body.appendChild(t);
  }
  if(color) t.style.borderColor=color;
  t.innerHTML=`<span style="font-size:24px">${ic}</span><div><div style="font-size:14px;font-weight:700;color:#e8edf5">${title}</div>${sub?`<div style="font-size:12px;color:#5a6b88;margin-top:2px">${sub}</div>`:''}</div>`;
  t.style.transform='translateY(0)'; t.style.opacity='1';
  clearTimeout(t._timer);
  t._timer=setTimeout(()=>{t.style.transform='translateY(80px)';t.style.opacity='0';},3500);
}

// ‚îÄ‚îÄ BATTLE MODE ‚îÄ‚îÄ
const Battle = (function(){
  const QBANK_BATTLE = {
    toan:[
      {q:'‚à´2x dx = ?',o:['x¬≤+C','x¬≤/2+C','2x¬≤+C','2+C'],a:0},
      {q:'ƒê·∫°o h√†m c·ªßa x¬≥ l√†?',o:['3x','3x¬≤','x¬≤','2x¬≥'],a:1},
      {q:'log‚ÇÇ(8) = ?',o:['2','3','4','8'],a:1},
      {q:'sin(90¬∞) = ?',o:['0','1','-1','‚àö2/2'],a:1},
      {q:'Di·ªán t√≠ch h√¨nh tr√≤n b√°n k√≠nh r?',o:['œÄr','2œÄr','œÄr¬≤','4œÄr¬≤'],a:2},
      {q:'(a+b)¬≤ = ?',o:['a¬≤+b¬≤','a¬≤+ab+b¬≤','a¬≤+2ab+b¬≤','2a¬≤+2b¬≤'],a:2},
      {q:'Nghi·ªám c·ªßa 2x+6=0 l√†?',o:['x=3','x=-3','x=6','x=-6'],a:1},
      {q:'C(5,2) = ?',o:['10','20','5','15'],a:0},
      {q:'cos(0¬∞) = ?',o:['0','1','-1','1/2'],a:1},
      {q:'Gi·ªõi h·∫°n lim(x‚Üí‚àû) 1/x = ?',o:['1','‚àû','0','-1'],a:2},
    ],
    ly:[
      {q:'F=ma. N·∫øu F=10N, m=2kg th√¨ a=?',o:['5 m/s¬≤','20 m/s¬≤','8 m/s¬≤','12 m/s¬≤'],a:0},
      {q:'T·ªëc ƒë·ªô √°nh s√°ng x·∫•p x·ªâ?',o:['3√ó10‚Å∂ m/s','3√ó10‚Å∏ m/s','3√ó10¬π‚Å∞ m/s','3√ó10‚Å¥ m/s'],a:1},
      {q:'ƒê∆°n v·ªã ƒëo l·ª±c l√†?',o:['Pascal','Joule','Newton','Watt'],a:2},
      {q:'C√¥ng th·ª©c t√≠nh ƒë·ªông nƒÉng?',o:['mv','¬Ωmv¬≤','ma','F√ód'],a:1},
      {q:'P=U√óI l√† c√¥ng th·ª©c t√≠nh?',o:['ƒêi·ªán tr·ªü','C√¥ng su·∫•t','ƒêi·ªán √°p','C∆∞·ªùng ƒë·ªô'],a:1},
      {q:'Chu k·ª≥ T = 1/f, f l√†?',o:['Bi√™n ƒë·ªô','Pha ban ƒë·∫ßu','T·∫ßn s·ªë','G√≥c pha'],a:2},
      {q:'Hi·ªán t∆∞·ª£ng kh√∫c x·∫° √°nh s√°ng x·∫£y ra khi?',o:['√Ånh s√°ng ph·∫£n x·∫°','√Ånh s√°ng ƒëi qua 2 m√¥i tr∆∞·ªùng','√Ånh s√°ng t·∫Øt','Nhi·ªÖu x·∫°'],a:1},
      {q:'ƒê∆°n v·ªã ƒëi·ªán tr·ªü l√†?',o:['Volt','Ampere','Ohm','Farad'],a:2},
    ],
    hoa:[
      {q:'S·ªë hi·ªáu nguy√™n t·ª≠ c·ªßa Natri (Na)?',o:['10','11','12','13'],a:1},
      {q:'C√¥ng th·ª©c h√≥a h·ªçc c·ªßa n∆∞·ªõc?',o:['H‚ÇÇO‚ÇÇ','HO','H‚ÇÇO','H‚ÇÉO'],a:2},
      {q:'NaOH l√†?',o:['Axit','Baz∆°','Mu·ªëi','Oxit axit'],a:1},
      {q:'Ph·∫£n ·ª©ng tr√°ng b·∫°c d√πng ƒë·ªÉ nh·∫≠n bi·∫øt?',o:['Glucozo','Fructozo','Saccarozo','Tinh b·ªôt'],a:0},
      {q:'CO‚ÇÇ l√† oxit g√¨?',o:['Oxit baz∆°','Oxit l∆∞·ª°ng t√≠nh','Oxit axit','Oxit trung t√≠nh'],a:2},
      {q:'Kh√≠ g√¢y hi·ªáu ·ª©ng nh√† k√≠nh ch·ªß y·∫øu?',o:['O‚ÇÇ','N‚ÇÇ','CO‚ÇÇ','H‚ÇÇ'],a:2},
      {q:'Polyme ƒë∆∞·ª£c t·ªïng h·ª£p t·ª´?',o:['Monome','Dime','Polyme nh·ªè h∆°n','Nguy√™n t·ª≠'],a:0},
      {q:'Kim lo·∫°i n√†o d·∫´n ƒëi·ªán t·ªët nh·∫•t?',o:['V√†ng','S·∫Øt','B·∫°c','Nh√¥m'],a:2},
    ],
    anh:[
      {q:'"She ___ to school every day."',o:['go','goes','going','gone'],a:1},
      {q:'Antonym of "generous"?',o:['kind','stingy','brave','honest'],a:1},
      {q:'"I wish I ___ more money."',o:['have','had','will have','has'],a:1},
      {q:'Passive: "They built this bridge." ‚Üí',o:['This bridge built','This bridge is built','This bridge was built','This bridge were built'],a:2},
      {q:'"Good at" + ?',o:['V-inf','V-ed','V-ing','V-s'],a:2},
      {q:'Which word is a noun?',o:['beautiful','quickly','happiness','run'],a:2},
      {q:'"It is high time we ___."',o:['leave','left','leaving','to leave'],a:1},
      {q:'"Put off" means?',o:['cancel','postpone','hurry','finish'],a:1},
    ],
    mix:[]
  };
  // Build mix from all
  Object.keys(QBANK_BATTLE).filter(k=>k!=='mix').forEach(k=>{
    QBANK_BATTLE.mix.push(...QBANK_BATTLE[k]);
  });

  let overlay, state={};

  function buildOverlay(){
    const el=document.createElement('div');
    el.id='battle-ov';
    el.style.cssText='display:none;position:fixed;inset:0;background:rgba(0,0,0,.92);backdrop-filter:blur(20px);z-index:500;align-items:center;justify-content:center;';
    el.innerHTML=`
    <div id="battle-box" style="width:700px;max-width:95vw;background:#0d1117;border:1px solid #1e2840;border-radius:24px;overflow:hidden;box-shadow:0 40px 100px rgba(0,0,0,.7);">
      <!-- LOBBY -->
      <div id="bt-lobby" style="padding:40px;text-align:center;">
        <div style="font-size:52px;margin-bottom:12px;animation:pulse2 1.5s ease-in-out infinite">‚öîÔ∏è</div>
        <h2 style="font-size:28px;font-weight:900;margin-bottom:8px;background:linear-gradient(135deg,#00e5ff,#7c3aed);-webkit-background-clip:text;-webkit-text-fill-color:transparent">Battle Mode</h2>
        <p style="color:#5a6b88;margin-bottom:28px;font-size:14px">10 c√¢u ¬∑ 15 gi√¢y/c√¢u ¬∑ ƒêi·ªÉm theo t·ªëc ƒë·ªô</p>
        <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;margin-bottom:24px;" id="bt-subj-grid">
          <div class="bt-sopt active" data-s="mix" onclick="Battle.selSubj(this,'mix')">üé≤ T·ªïng h·ª£p</div>
          <div class="bt-sopt" data-s="toan" onclick="Battle.selSubj(this,'toan')">üìê To√°n</div>
          <div class="bt-sopt" data-s="ly" onclick="Battle.selSubj(this,'ly')">‚ö° V·∫≠t l√Ω</div>
          <div class="bt-sopt" data-s="hoa" onclick="Battle.selSubj(this,'hoa')">üß™ H√≥a</div>
          <div class="bt-sopt" data-s="anh" onclick="Battle.selSubj(this,'anh')">üåç Anh</div>
        </div>
        <button onclick="Battle.start()" style="width:100%;padding:16px;background:linear-gradient(135deg,#00e5ff,#0099cc);border:none;border-radius:12px;color:#000;font-size:16px;font-weight:800;cursor:pointer;font-family:inherit;transition:.2s;" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform=''">‚ö° B·∫Øt ƒë·∫ßu!</button>
        <button onclick="Battle.close()" style="margin-top:10px;width:100%;padding:10px;background:none;border:1px solid #1e2840;border-radius:12px;color:#5a6b88;font-size:14px;font-weight:600;cursor:pointer;font-family:inherit;">‚úï ƒê√≥ng</button>
      </div>
      <!-- GAME -->
      <div id="bt-game" style="display:none;">
        <div style="padding:16px 24px;border-bottom:1px solid #1e2840;display:flex;align-items:center;justify-content:space-between;">
          <div style="font-size:13px;color:#5a6b88;font-weight:600" id="bt-qnum">C√¢u 1/10</div>
          <div id="bt-timer-wrap" style="display:flex;align-items:center;gap:8px;">
            <div id="bt-timer-bar-wrap" style="width:120px;height:6px;background:#1e2840;border-radius:999px;overflow:hidden;">
              <div id="bt-timer-bar" style="height:100%;background:linear-gradient(90deg,#00e5ff,#7c3aed);border-radius:999px;transition:width .1s linear;"></div>
            </div>
            <div id="bt-timer" style="font-family:'Space Mono';font-size:20px;font-weight:900;color:#f59e0b;min-width:28px;text-align:right;">15</div>
          </div>
          <div id="bt-score-display" style="font-family:'Space Mono';font-size:16px;font-weight:800;color:#00e5ff;">0 pts</div>
        </div>
        <div style="padding:28px 28px 20px;">
          <div id="bt-qtxt" style="font-size:20px;font-weight:700;line-height:1.6;margin-bottom:22px;min-height:60px;"></div>
          <div id="bt-opts" style="display:grid;grid-template-columns:1fr 1fr;gap:10px;"></div>
          <div id="bt-explain" style="display:none;margin-top:16px;padding:14px 16px;background:rgba(16,185,129,.06);border:1px solid rgba(16,185,129,.2);border-radius:12px;font-size:13px;line-height:1.7;"></div>
        </div>
      </div>
      <!-- RESULT -->
      <div id="bt-result" style="display:none;padding:40px;text-align:center;"></div>
    </div>`;
    // Add styles
    const style=document.createElement('style');
    style.textContent=`
    #battle-ov.show{display:flex!important}
    .bt-sopt{padding:12px 8px;background:#111622;border:2px solid #1e2840;border-radius:12px;cursor:pointer;font-size:13px;font-weight:700;color:#5a6b88;transition:.2s;text-align:center;}
    .bt-sopt:hover{border-color:#5a6b88;color:#e8edf5;}
    .bt-sopt.active{background:rgba(0,229,255,.08);border-color:#00e5ff;color:#00e5ff;}
    .bt-opt{padding:14px 16px;background:#111622;border:2px solid #1e2840;border-radius:12px;cursor:pointer;font-size:14px;font-weight:600;color:#e8edf5;transition:.2s;text-align:left;display:flex;align-items:center;gap:10px;}
    .bt-opt:hover:not(.locked){border-color:#00e5ff;background:rgba(0,229,255,.04);transform:translateY(-1px);}
    .bt-opt.correct{border-color:#10b981!important;background:rgba(16,185,129,.12)!important;color:#10b981!important;animation:correctPop .3s ease;}
    .bt-opt.wrong{border-color:#ef4444!important;background:rgba(239,68,68,.1)!important;color:#ef4444!important;animation:wrongShake .3s ease;}
    .bt-opt.reveal{border-color:#10b981;background:rgba(16,185,129,.06);color:#10b981;}
    .bt-olbl{width:24px;height:24px;border-radius:6px;background:#1e2840;display:grid;place-items:center;font-size:12px;font-weight:800;flex-shrink:0;font-family:'Space Mono';}
    .bt-opt.correct .bt-olbl{background:#10b981;color:#fff;}
    .bt-opt.wrong .bt-olbl{background:#ef4444;color:#fff;}
    @keyframes pulse2{0%,100%{transform:scale(1)}50%{transform:scale(1.1)}}
    @keyframes correctPop{0%{transform:scale(1)}40%{transform:scale(1.03)}100%{transform:scale(1)}}
    @keyframes wrongShake{0%,100%{transform:translateX(0)}20%{transform:translateX(-5px)}60%{transform:translateX(5px)}}
    @keyframes btScorePop{0%{transform:scale(1)}50%{transform:scale(1.3)}100%{transform:scale(1)}}
    `;
    document.head.appendChild(style);
    document.body.appendChild(el);
    overlay=el;
  }

  let selectedSubj='mix', timerI=null, timeLeft=15, currentQ=0, questions=[], answers=[], score=0;

  function open(){
    if(!overlay) buildOverlay();
    document.getElementById('bt-lobby').style.display='block';
    document.getElementById('bt-game').style.display='none';
    document.getElementById('bt-result').style.display='none';
    overlay.classList.add('show');
    document.body.style.overflow='hidden';
  }
  function close(){
    if(overlay) overlay.classList.remove('show');
    document.body.style.overflow='';
    clearInterval(timerI);
  }
  function selSubj(el, subj){
    selectedSubj=subj;
    document.querySelectorAll('.bt-sopt').forEach(e=>e.classList.remove('active'));
    el.classList.add('active');
  }
  function start(){
    SFX.battle_start();
    const pool=[...(QBANK_BATTLE[selectedSubj]||QBANK_BATTLE.mix)].sort(()=>Math.random()-.5);
    questions=pool.slice(0,10);
    answers=[];
    score=0;
    currentQ=0;
    document.getElementById('bt-lobby').style.display='none';
    document.getElementById('bt-game').style.display='block';
    document.getElementById('bt-result').style.display='none';
    renderQ();
  }
  function renderQ(){
    if(currentQ>=questions.length){showResult();return;}
    const q=questions[currentQ];
    document.getElementById('bt-qnum').textContent=`C√¢u ${currentQ+1}/10`;
    document.getElementById('bt-score-display').textContent=score+' pts';
    document.getElementById('bt-qtxt').textContent=q.q;
    document.getElementById('bt-explain').style.display='none';
    document.getElementById('bt-opts').innerHTML=q.o.map((o,i)=>`
      <div class="bt-opt" onclick="Battle._answer(${i})" data-idx="${i}">
        <span class="bt-olbl">${['A','B','C','D'][i]}</span>${o}
      </div>`).join('');
    startTimer();
  }
  function startTimer(){
    clearInterval(timerI);
    timeLeft=15;
    updateTimerUI();
    timerI=setInterval(()=>{
      timeLeft--;
      updateTimerUI();
      if(timeLeft<=5) SFX.countdown();
      if(timeLeft<=0){clearInterval(timerI);_answer(-1);}
    },1000);
  }
  function updateTimerUI(){
    document.getElementById('bt-timer').textContent=timeLeft;
    document.getElementById('bt-timer-bar').style.width=(timeLeft/15*100)+'%';
    const col=timeLeft<=5?'#ef4444':timeLeft<=10?'#f59e0b':'';
    document.getElementById('bt-timer').style.color=col||'#f59e0b';
    document.getElementById('bt-timer-bar').style.background=timeLeft<=5?'#ef4444':timeLeft<=10?'linear-gradient(90deg,#f59e0b,#ef4444)':'linear-gradient(90deg,#00e5ff,#7c3aed)';
  }
  function _answer(idx){
    clearInterval(timerI);
    const q=questions[currentQ];
    const correct=idx===q.a;
    const timeBonus=Math.max(0,timeLeft);
    const pts=correct?100+timeBonus*10:0;
    score+=pts;
    answers.push({q:q.q,chosen:idx,correct:q.a,isCorrect:correct,pts});
    // Lock all options
    document.querySelectorAll('.bt-opt').forEach(el=>{
      el.classList.add('locked');
      el.style.cursor='default';
      el.onclick=null;
    });
    // Highlight
    document.querySelectorAll('.bt-opt').forEach(el=>{
      const i=parseInt(el.dataset.idx);
      if(i===q.a) el.classList.add('correct');
      else if(i===idx && idx!==q.a) el.classList.add('wrong');
    });
    if(correct){SFX.correct();if(pts>200)Confetti.burst(40);}
    else SFX.wrong();
    document.getElementById('bt-score-display').textContent=score+' pts';
    document.getElementById('bt-score-display').style.animation='btScorePop .3s ease';
    setTimeout(()=>document.getElementById('bt-score-display').style.animation='',300);
    // Show explain briefly then next
    if(idx===-1){
      const exp=document.getElementById('bt-explain');
      exp.innerHTML=`‚è∞ <strong>H·∫øt gi·ªù!</strong> ƒê√°p √°n ƒë√∫ng: <strong>${['A','B','C','D'][q.a]}. ${q.o[q.a]}</strong>`;
      exp.style.display='block';
    }
    currentQ++;
    setTimeout(()=>renderQ(), correct?600:1000);
  }
  function showResult(){
    SFX.finish();
    const total=questions.length;
    const correct=answers.filter(a=>a.isCorrect).length;
    const pct=Math.round(correct/total*100);
    if(pct>=80) Confetti.burst(150);
    document.getElementById('bt-game').style.display='none';
    document.getElementById('bt-result').style.display='block';
    const grade=pct>=90?'üèÜ Huy·ªÅn tho·∫°i!':pct>=70?'‚≠ê Xu·∫•t s·∫Øc!':pct>=50?'üí™ Kh√° t·ªët!':'üìñ C·∫ßn √¥n th√™m!';
    const col=pct>=70?'#10b981':pct>=50?'#f59e0b':'#ef4444';
    document.getElementById('bt-result').innerHTML=`
      <div style="font-size:52px;margin-bottom:12px">${pct>=80?'üèÜ':pct>=60?'‚≠ê':'üí™'}</div>
      <div style="font-size:56px;font-weight:900;font-family:'Space Mono';color:${col};line-height:1;margin-bottom:4px">${score}</div>
      <div style="font-size:13px;color:#5a6b88;margin-bottom:8px">ƒëi·ªÉm</div>
      <div style="font-size:18px;font-weight:800;margin-bottom:4px">${grade}</div>
      <div style="font-size:13px;color:#5a6b88;margin-bottom:28px">${correct}/${total} c√¢u ƒë√∫ng</div>
      <div style="display:flex;gap:8px;justify-content:center;flex-wrap:wrap">
        <button onclick="Battle.start()" style="padding:12px 24px;background:linear-gradient(135deg,#00e5ff,#0099cc);border:none;border-radius:10px;color:#000;font-weight:800;cursor:pointer;font-size:14px;font-family:inherit">üîÅ Ch∆°i l·∫°i</button>
        <button onclick="Battle.close()" style="padding:12px 24px;background:#111622;border:1px solid #1e2840;border-radius:10px;color:#5a6b88;font-weight:700;cursor:pointer;font-size:14px;font-family:inherit">‚úï ƒê√≥ng</button>
      </div>`;
    // Save high score
    const best=parseInt(localStorage.getItem('lt369_battle_best')||'0');
    if(score>best){
      localStorage.setItem('lt369_battle_best',score);
      showToast('üèÜ','K·ª∑ l·ª•c m·ªõi!',`${score} ƒëi·ªÉm ‚Äì Battle Mode`,'#f59e0b');
    }
  }
  return {open,close,start,selSubj,_answer};
})();

// ‚îÄ‚îÄ STREAK MILESTONE CONFETTI ‚îÄ‚îÄ
function checkStreakMilestone(){
  const streak=parseInt(localStorage.getItem('lt369_streak')||'0');
  const lastMile=parseInt(localStorage.getItem('lt369_last_milestone')||'0');
  const milestones=[3,7,14,21,30,50,100];
  const hit=milestones.find(m=>streak>=m&&lastMile<m);
  if(hit){
    localStorage.setItem('lt369_last_milestone',hit);
    setTimeout(()=>{
      Confetti.burst(200);
      SFX.streak();
      showToast('üî•',`Streak ${hit} ng√†y!`,hit>=30?'üèÜ Si√™u phi th∆∞·ªùng!':hit>=14?'üåü Tuy·ªát v·ªùi!':'üí™ Ti·∫øp t·ª•c nh√©!','#f59e0b');
    },800);
  }
}

// ‚îÄ‚îÄ POMODORO ‚îÄ‚îÄ
const Pomodoro = (function(){
  let overlay, timerI=null, secsLeft=25*60, mode='work', workMins=25;
  function init(){
    if(overlay) return;
    overlay=document.createElement('div');
    overlay.id='pomo-widget';
    overlay.style.cssText='position:fixed;bottom:80px;right:24px;z-index:400;background:#0d1117;border:1px solid #1e2840;border-radius:18px;padding:18px 22px;width:220px;box-shadow:0 12px 40px rgba(0,0,0,.5);display:none;';
    overlay.innerHTML=`
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
        <div style="font-size:13px;font-weight:700;color:#e8edf5" id="pomo-label">üçÖ Pomodoro</div>
        <button onclick="Pomodoro.close()" style="background:none;border:none;color:#5a6b88;cursor:pointer;font-size:16px;line-height:1">‚úï</button>
      </div>
      <div style="text-align:center;margin-bottom:14px;">
        <div id="pomo-time" style="font-size:42px;font-weight:900;font-family:'Space Mono';color:#00e5ff;line-height:1;">25:00</div>
        <div id="pomo-mode" style="font-size:11px;color:#5a6b88;margin-top:4px;text-transform:uppercase;letter-spacing:1px;">T·∫≠p trung</div>
      </div>
      <div style="height:4px;background:#1e2840;border-radius:999px;margin-bottom:14px;overflow:hidden;">
        <div id="pomo-bar" style="height:100%;background:linear-gradient(90deg,#00e5ff,#7c3aed);border-radius:999px;width:100%;transition:width .5s linear;"></div>
      </div>
      <div style="display:flex;gap:8px;">
        <button id="pomo-btn" onclick="Pomodoro.toggle()" style="flex:1;padding:10px;background:linear-gradient(135deg,#00e5ff,#0099cc);border:none;border-radius:10px;color:#000;font-weight:800;cursor:pointer;font-size:13px;font-family:inherit;">‚ñ∂ B·∫Øt ƒë·∫ßu</button>
        <button onclick="Pomodoro.reset()" style="padding:10px 12px;background:#111622;border:1px solid #1e2840;border-radius:10px;color:#5a6b88;cursor:pointer;font-size:13px;font-family:inherit;">‚Ü∫</button>
      </div>`;
    document.body.appendChild(overlay);
  }
  const totalSecs=()=>mode==='work'?workMins*60:5*60;
  function updateUI(){
    const m=Math.floor(secsLeft/60),s=secsLeft%60;
    document.getElementById('pomo-time').textContent=String(m).padStart(2,'0')+':'+String(s).padStart(2,'0');
    document.getElementById('pomo-bar').style.width=(secsLeft/totalSecs()*100)+'%';
    document.getElementById('pomo-mode').textContent=mode==='work'?'T·∫≠p trung':'Ngh·ªâ gi·∫£i lao';
    const col=mode==='work'?secsLeft<=60?'#ef4444':'#00e5ff':'#10b981';
    document.getElementById('pomo-time').style.color=col;
  }
  function open(){init();overlay.style.display='block';}
  function close(){if(overlay)overlay.style.display='none';clearInterval(timerI);timerI=null;}
  function toggle(){
    if(timerI){clearInterval(timerI);timerI=null;document.getElementById('pomo-btn').textContent='‚ñ∂ Ti·∫øp t·ª•c';}
    else{
      document.getElementById('pomo-btn').textContent='‚è∏ D·ª´ng';
      timerI=setInterval(()=>{
        secsLeft--;
        updateUI();
        if(secsLeft<=0){
          clearInterval(timerI);timerI=null;
          SFX.finish();
          if(mode==='work'){
            mode='break';secsLeft=5*60;
            showToast('‚òï','Ngh·ªâ 5 ph√∫t!','B·∫°n ƒë√£ t·∫≠p trung 25 ph√∫t, ngh·ªâ ng∆°i n√†o!','#10b981');
          } else {
            mode='work';secsLeft=workMins*60;
            showToast('üçÖ','B·∫Øt ƒë·∫ßu phi√™n m·ªõi!','T·∫≠p trung 25 ph√∫t!','#00e5ff');
          }
          document.getElementById('pomo-btn').textContent='‚ñ∂ B·∫Øt ƒë·∫ßu';
          updateUI();
        }
      },1000);
    }
  }
  function reset(){clearInterval(timerI);timerI=null;mode='work';secsLeft=workMins*60;document.getElementById('pomo-btn').textContent='‚ñ∂ B·∫Øt ƒë·∫ßu';updateUI();}
  return {open,close,toggle,reset};
})();


</script>
</body></html>
